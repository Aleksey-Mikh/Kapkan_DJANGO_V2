{% extends 'shop/base.html' %}
{% load static %}

{% block title %} Профиль {{ user.username }} | {{ block.super }}{% endblock %}

{% block style %}
<link rel="stylesheet" type="text/css" href="{% static 'shop/css/detail.css' %}?" ?>
<link rel="stylesheet" type="text/css" href="{% static 'shop/css/cart.css' %}" ?>
{% endblock %}

{% block content %}
<section class="content-detail">
    <h1>Личный кабинет</h1>
    <p>Вы можете изменить ваши данные при помощи этой формы:</p>
    <form action="." method="post" enctype="multipart/form-data">
        {{ user_form.as_p }}
        {{ profile_form.as_p }}
        {% csrf_token %}
        <p><input type="submit" value="Сохранить изменения"></p>
    </form>
    <br>
    <br>

    {% for order in customer %}

    <div class="table-cart">
        <h2>Номер заказа: {{ order.pk }}</h2>
        <h2>Коментарий: {% if order.comment_for_order %}
            {{ order.comment_for_order }}
            {% else %}
            Нет коменнтария к заказу
            {% endif %}</h2>
        <h2>Статус:
            {% if "new" in order.status %}
            Новый заказ
            {% else %}
            {% if "in_progress" in order.status %}
            Заказ в обработке
            {% else %}
            Заказ готов
            {% endif %}
            {% endif %}</h2>
        <table>
            <tr>
                <th>Фото</th>
                <th>Товар</th>
                <th>Количество</th>
                <th>Цена</th>
            </tr>
            {% for item in order.items.all %}
            <tr>
                <td>
                    <a href="{{ item.product.get_absolute_url }}">
                        <img src="{{ item.product.image.url }}" class="cart-image">
                    </a>
                </td>
                <td>
                    <a href="{{ item.product.get_absolute_url }}">
                        {{ item.product.title }}
                    </a>
                </td>
                <td>{{ item.quantity }}</td>
                <td>{{ item.price_x_items }} руб.</td>
            </tr>
            {% if forloop.last %}

            {% endif %}
            {% endfor %}
            <tr>
                <th colspan="3" class="total-price">Общая цена</th>
                <th>{{ order.get_total_cost }} руб.</th>
            </tr>
        </table>
    </div>
    <br>
    <br>
    {% endfor %}

</section>
{% endblock %}